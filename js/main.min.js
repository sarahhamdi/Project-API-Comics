var myAPIProject={},deferred=new $.Deferred,promise=deferred.promise(),template;myAPIProject.counter=0,myAPIProject.endpoint="https://sheetsu.com/apis/14561de4",myAPIProject.getSheetsuAPIInfo=function(){$.ajax({url:myAPIProject.endpoint,method:"GET",dataType:"json"}).then(function(o){myAPIProject.data=o,myAPIProject.onSubmitHandler()})},myAPIProject.goodreadsAPI={},myAPIProject.goodreadsAPI.endpoint="https://www.goodreads.com/book/title.xml",myAPIProject.goodreadsAPI.key="AYoaCzPGXisCTWsP6Ainw",myAPIProject.goodreadsAPI.getBooks=function(o){$.ajax({url:"http://proxy.hackeryou.com",dataType:"json",method:"GET",data:{reqUrl:myAPIProject.goodreadsAPI.endpoint,params:{key:myAPIProject.goodreadsAPI.key,title:o.bookTitle},xmlToJSON:!0}}).then(function(t){$("div.container").append(myAPIProject.printToPage(t,o))})},myAPIProject.onSubmitHandler=function(){var o,t=[];$("form.choose-comics").on("submit",function(r){$("div.container").empty(),t=[],r.preventDefault(),$("input:checked").each(function(){o=$(this).val(),t.push(o)}),myAPIProject.datafilters(t)})},myAPIProject.datafilters=function(o){myAPIProject.authorP=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC}),myAPIProject.authorQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorLGBTQ}),myAPIProject.charP=myAPIProject.data.result.filter(function(o){return"y"==o.characterPoC}),myAPIProject.charQ=myAPIProject.data.result.filter(function(o){return"y"==o.characterLGBTQ}),myAPIProject.charPQ=myAPIProject.data.result.filter(function(o){return"y"==o.characterLGBTQ&&"y"==o.characterPoC}),myAPIProject.authorPQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC&&"y"==o.authorLGBTQ}),myAPIProject.authorPQcharP=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC&&"y"==o.authorLGBTQ&&"y"==o.characterPoC}),myAPIProject.authorPQcharQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC&&"y"==o.authorLGBTQ&&"y"==o.characterLGBTQ}),myAPIProject.authorPQcharPQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC&&"y"==o.authorLGBTQ&&"y"==o.characterPoC&&"y"==o.characterLGBTQ}),myAPIProject.authorPcharP=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC&&"y"==o.characterPoC}),myAPIProject.authorPcharQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC&&"y"==o.characterLGBTQ}),myAPIProject.authorPcharPQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorPoC&&"y"==o.characterPoC&&"y"==o.characterLGBTQ}),myAPIProject.authorQcharP=myAPIProject.data.result.filter(function(o){return"y"==o.authorLGBTQ&&"y"==o.characterPoC}),myAPIProject.authorQcharQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorLGBTQ&&"y"==o.characterLGBTQ}),myAPIProject.authorQcharPQ=myAPIProject.data.result.filter(function(o){return"y"==o.authorLGBTQ&&"y"==o.characterPoC&&"y"==o.characterLGBTQ}),myAPIProject.giantIfElseStatement(o)},myAPIProject.giantIfElseStatement=function(o){"authorPoC"==o[0]&&"authorLGBTQ"==o[1]&&"characterPoC"==o[2]&&"characterLGBTQ"==o[3]?_.each(myAPIProject.authorPQcharPQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorPoC"==o[0]&&"authorLGBTQ"==o[1]&&"characterPoC"==o[2]?_.each(myAPIProject.authorPQcharP,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorPoC"==o[0]&&"authorLGBTQ"==o[1]&&"characterLGBTQ"==o[2]?_.each(myAPIProject.authorPQcharQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorPoC"==o[0]&&"characterPoC"==o[1]&&"characterLGBTQ"==o[2]?_.each(myAPIProject.authorPcharPQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorLGBTQ"==o[0]&&"characterPoC"==o[1]&&"characterLGBTQ"==o[2]?_.each(myAPIProject.authorQcharPQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorPoC"==o[0]&&"characterPoC"==o[1]?_.each(myAPIProject.authorPcharP,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorPoC"==o[0]&&"characterLGBTQ"==o[1]?_.each(myAPIProject.authorPcharQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorPoC"==o[0]&&"authorLGBTQ"==o[1]?_.each(myAPIProject.authorPQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"characterPoC"==o[0]&&"characterLGBTQ"==o[1]?_.each(myAPIProject.charPQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorLGBTQ"==o[0]&&"characterPoC"==o[1]?_.each(myAPIProject.authorQcharP,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorLGBTQ"==o[0]&&"characterLGBTQ"==o[1]?_.each(myAPIProject.authorQcharQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorPoC"==o[0]?_.each(myAPIProject.authorP,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"authorLGBTQ"==o[0]?_.each(myAPIProject.authorQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"characterPoC"==o[0]?_.each(myAPIProject.charP,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++}):"characterLGBTQ"==o[0]&&_.each(myAPIProject.charQ,function(o){myAPIProject.goodreadsAPI.getBooks(o),myAPIProject.counter++})},myAPIProject.printToPage=function(o,t,r){function e(o,t){for(var r=[],e=-1;(e=t.indexOf(o,e+1))>=0;)r.push(e);var a=r[1];return a}var a=parseInt(o.GoodreadsResponse.book.average_rating),c=[];for(m=0;m<a;m++)c.push('<img src="assets/star.svg">');c=c.join(" ");var P=function(o){return o.replace(/&lt;\/*[a-z]*&gt;/g," ").replace(/&amp;/g,"&")},n=o.GoodreadsResponse.book.title,u=n.split(" "),u=u.join("+"),h="http://www.torontopubliclibrary.ca/search.jsp?advancedSearch=true&Ntt=",s=o.GoodreadsResponse.book.image_url,i=/nophoto/,y=i.exec(s),I=o.GoodreadsResponse.book.image_url,A=e("m",I),d=I.split(""),j=d.map(function(o,t){return t===A?o="l":o}).join(""),l={title:o.GoodreadsResponse.book.title,author:"By: "+t.author,publisher:"Publisher: "+o.GoodreadsResponse.book.publisher,description:P(o.GoodreadsResponse.book.description),stars:c,goodreadsLink:o.GoodreadsResponse.book.url,tpl:h+u,imageUrl:"assets/blankcover.png",listID:"item-"+myAPIProject.counter},f=$("#myTemplate").html();template=Handlebars.compile(f),null==i.exec(y)?l.imageUrl=j:"http://covers.openlibrary.org/b/isbn/"+o.GoodreadsResponse.book.isbn+"-L.jpg"!="http://covers.openlibrary.org/b/isbn/[object Object]-L.jpg"&&(l.imageUrl="http://covers.openlibrary.org/b/isbn/"+o.GoodreadsResponse.book.isbn+"-L.jpg"),$("div.container").css({display:"block"}),$("div.container").append(template(l))},myAPIProject.submitFormThankYouAppear=function(){"http://localhost:3000/#thankyou"==document.URL?$("aside#form-thank-you").css("display","block"):$("aside#form-thank-you").css("display","none")},myAPIProject.init=function(){myAPIProject.getSheetsuAPIInfo(),myAPIProject.submitFormThankYouAppear(),$(function(){$('a[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var o=$(this.hash);if(o=o.length?o:$("[name="+this.hash.slice(1)+"]"),o.length)return $("html, body").animate({scrollTop:o.offset().top},1e3),!1}})})},$(function(){myAPIProject.init()});