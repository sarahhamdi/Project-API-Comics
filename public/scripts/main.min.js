"use strict";var helpers={};helpers.cleanup=function(e){return e.replace(/&lt;\/*[a-z]*&gt;/g,"").replace(/&amp;/g,"&").replace(/&lt;br \/&gt;/g," ")},helpers.rating=function(e){for(var r=[],o=parseInt(e),s=0;s<o;s++)r.push('<img src="public/assets/star.svg">');return r=r.join(" ")},helpers.tpl=function(e){var r="http://www.torontopubliclibrary.ca/search.jsp?Ntt="+e;return r},helpers.bookcovers=function(e,r){var o=e,s=/nophoto/,t=s.exec(o),n=e.replace(/m\//g,"l/").replace(/col\//g,"com/");return o=null===s.exec(t)?n:"http://covers.openlibrary.org/b/isbn/"+parseInt(r)+"-L.jpg?default=false"},helpers.bookcoversBlank=function(){$(".bookcover").on("error",function(){console.log("a 404 error"),$(this).attr("src","public/assets/blankcover.png")})},helpers.resetSlider=function(){$(".wrapper").empty()},helpers.printToPage=function(e){var r=e.GoodreadsResponse.book,o=r.title,s=helpers.tpl(r.isbn),t=helpers.bookcovers(r.image_url,r.isbn),n=helpers.cleanup(r.description),a=helpers.rating(r.average_rating),c=r.link,p=void 0,i=(p="[object Object]"==r.publisher?"Not Available":r.publisher,[]),u=(r.authors.author.name?i=r.authors.author.name:r.authors.author.forEach(function(e){i.push(" "+e.name)}),'<p><img src="'+t+'" class="bookcover"></p>\n        <h2>'+o+"</h2>\n        <h3>By: "+i+"</h3>\n        <h4>Publisher: "+p+"</h4>\n        <p>"+n+'</p>\n        <p><a href="'+c+'">Goodreads Rating</a></p>\n        <p>'+a+'</p>\n        <p><a href="'+s+'">Search TPL</a></p>');$(".wrapper").append('<div class="slide">'+u+"</div>"),helpers.bookcoversBlank()};var sheetsu={},goodreads={},generic={},comicsApp={};comicsApp.userInputArray=[],sheetsu.books=[],sheetsu.endpoint="https://sheetsu.com/apis/v1.0/5fb1d566311d",goodreads.endpoint="https://www.goodreads.com/book/title.xml",goodreads.key="AYoaCzPGXisCTWsP6Ainw",generic.error=function(e){return console.log(e)},goodreads.success=function(e){console.log(e.GoodreadsResponse.book),helpers.printToPage(e)},sheetsu.success=function(e){sheetsu.filtered(e)},sheetsu.filtered=function(e){sheetsu.filteredBooks=e.filter(function(e){return comicsApp.userInputArray.every(function(r){return"y"===e[r]})}),sheetsu.filteredBooks.map(function(e){console.log(e.bookTitle),goodreads.getData(e.bookTitle)})},sheetsu.getData=function(){return $.ajax({url:sheetsu.endpoint,dataType:"json",type:"GET",success:sheetsu.success,error:generic.error})},goodreads.getData=function(e){return $.ajax({url:"http://proxy.hackeryou.com",dataType:"json",method:"GET",data:{reqUrl:goodreads.endpoint,params:{key:goodreads.key,title:e},xmlToJSON:!0},success:goodreads.success,error:generic.error})},comicsApp.getUserInput=function(){$(".choose-comics").on("submit",function(e){e.preventDefault(),comicsApp.userInputArray=[],helpers.resetSlider(),$("input:checked").each(function(){comicsApp.userInputArray.push($(this).val())}),sheetsu.getData()})},$(function(){comicsApp.getUserInput()});